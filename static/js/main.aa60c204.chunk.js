(this["webpackJsonpmesto-react"]=this["webpackJsonpmesto-react"]||[]).push([[0],{15:function(e,t,n){},17:function(e,t,n){"use strict";n.r(t);var a=n(1),c=n.n(a),i=n(7),s=n.n(i),r=(n(15),n(10)),o=n(2),l=n.p+"static/media/spinner.c233b9e0.svg",u=Object(a.createContext)({_id:null,name:"\u0417\u0430\u0433\u0440\u0443\u0437\u043a\u0430...",about:"",avatar:l}),d=n(8),b=n(9),j=new(function(){function e(t){Object(d.a)(this,e),this._baseUrl=t.baseUrl,this._headers=t.headers}return Object(b.a)(e,[{key:"_fetch",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"GET",n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:null,a="".concat(this._baseUrl,"/").concat(e),c={method:t,headers:this._headers};return n&&(c.body=JSON.stringify(n)),fetch(a,c).then((function(e){return e.ok?e.json():Promise.reject({statusCode:e.status,message:e.statusText})}))}},{key:"getUserInfo",value:function(){return this._fetch("users/me")}},{key:"getCardList",value:function(){return this._fetch("cards")}},{key:"updateProfile",value:function(e){return this._fetch("users/me","PATCH",e)}},{key:"postCard",value:function(e){return this._fetch("cards","POST",e)}},{key:"delete",value:function(e){return this._fetch("cards/".concat(e),"DELETE")}},{key:"like",value:function(e){var t=!(arguments.length>1&&void 0!==arguments[1])||arguments[1];return this._fetch("cards/likes/".concat(e),t?"PUT":"DELETE")}},{key:"updateAvatar",value:function(e){return this._fetch("users/me/avatar","PATCH",e)}}]),e}())({baseUrl:"https://mesto.nomoreparties.co/v1/cohort-21",headers:{authorization:"52186c90-0ae5-45bb-99b5-e4acaa2b939f","Content-Type":"application/json"}});function p(e){console.error(e.message)}var f=n.p+"static/media/logo.9efe1e8a.svg",m=n(0);var _=function(){return Object(m.jsx)("header",{className:"header container",children:Object(m.jsx)("a",{href:"/",className:"logo",target:"_self",children:Object(m.jsx)("img",{src:f,alt:"Mesto Russia",className:"logo__img"})})})};function O(e){var t=e.onClickDelete;return Object(m.jsx)("button",{type:"button","aria-label":"\u0423\u0434\u0430\u043b\u0438\u0442\u044c",className:"card__delete btn btn_type_delete",onClick:t})}function h(e){var t=e.isLiked,n=e.onClickLike,a="btn btn_type_like ".concat(t&&"btn_type_like-active");return Object(m.jsx)("button",{type:"button","aria-label":"\u041d\u0440\u0430\u0432\u0438\u0442\u0441\u044f",className:a,onClick:n})}var v=function(e){var t=e.card,n=e.onCardClick,c=e.onCardLike,i=e.onCardDelete,s=Object(a.useContext)(u)._id,r=t.owner._id===s,o=t.likes.some((function(e){return e._id===s}));return Object(m.jsx)("li",{className:"cards__list-item",children:Object(m.jsxs)("article",{className:"card",children:[r&&Object(m.jsx)(O,{onClickDelete:function(){i(t._id)}}),Object(m.jsx)("img",{src:t.link,alt:t.name,className:"card__image",onClick:function(){n(t)}}),Object(m.jsxs)("div",{className:"card__description",children:[Object(m.jsx)("h2",{className:"card__title",children:t.name}),Object(m.jsxs)("div",{className:"card__like",children:[Object(m.jsx)(h,{onClickLike:function(){c(t)},isLiked:o}),Object(m.jsx)("span",{className:"card__like-cnt",children:t.likes.length||""})]})]})]})})};function x(e){var t=e.step,n=e.speed,a=e.delay,c=e.color,i=e.size,s=i/2,r=i/e.count*.7,o=.6*s;return Object(m.jsx)("g",{transform:"rotate(".concat(t," ").concat(s," ").concat(s,")"),children:Object(m.jsx)("rect",{x:s-r/2,y:"0",rx:"3",ry:"7",width:r,height:o,fill:c,children:Object(m.jsx)("animate",{attributeName:"opacity",values:"1;0",keyTimes:"0;1",dur:"".concat(n,"ms"),begin:"-".concat(a,"ms"),repeatCount:"indefinite"})})})}var C=function(e){var t=e.count,n=void 0===t?10:t,a=e.speed,c=void 0===a?1e3:a,i=e.color,s=void 0===i?"#ffffff":i,r=e.size,o=void 0===r?100:r;return Object(m.jsx)("div",{className:"loader",children:Object(m.jsx)("svg",{className:"loader__svg",width:"".concat(o,"px"),height:"".concat(o,"px"),preserveAspectRatio:"xMidYMid",children:function(){for(var e=360/n,t=c/n,a=[],i=0,r=c;i<360;i+=e,r-=t)a.push(Object(m.jsx)(x,{step:i,delay:r,speed:c,color:s,size:o,count:n},i));return a}()})})};var g=function(e){var t,n=Object(a.useContext)(u),c=n.name,i=n.about,s=n.avatar,r=e.cards,o=e.onCardLike,l=e.onCardDelete,d=e.onAddPlace,b=e.onEditAvatar,j=e.onEditProfile,p=e.onCardClick,f=e.loading;return Object(m.jsxs)("main",{className:"content container",children:[Object(m.jsxs)("section",{className:"profile",children:[Object(m.jsx)("div",{className:"profile__avatar-wrapper",onClick:b,children:Object(m.jsx)("img",{src:s,alt:"\u0410\u0432\u0430\u0442\u0430\u0440",className:"profile__avatar"})}),Object(m.jsxs)("div",{className:"profile__details",children:[Object(m.jsxs)("div",{className:"profile__text",children:[Object(m.jsx)("h1",{className:"profile__name",children:c}),Object(m.jsx)("button",{type:"button","aria-label":"\u0420\u0435\u0434\u0430\u043a\u0442\u0438\u0440\u043e\u0432\u0430\u0442\u044c \u043f\u0440\u043e\u0444\u0438\u043b\u044c",className:"btn btn_type_edit-profile",onClick:j})]}),Object(m.jsx)("p",{className:"profile__about",children:i})]}),Object(m.jsx)("button",{type:"button","aria-label":"\u0414\u043e\u0431\u0430\u0432\u0438\u0442\u044c \u043d\u043e\u0432\u0443\u044e \u043a\u0430\u0440\u0442\u043e\u0447\u043a\u0443",className:"btn btn_type_add-card",onClick:d})]}),Object(m.jsx)("section",{className:"cards",children:f?Object(m.jsx)(C,{}):(t=r,Object(m.jsx)("ul",{className:"cards__list",children:t.map((function(e){return Object(m.jsx)(v,{card:e,onCardLike:o,onCardDelete:l,onCardClick:p},e._id)}))}))})]})};var y=function(){return Object(m.jsx)("footer",{className:"footer container",children:Object(m.jsx)("p",{className:"footer__copyright",children:"\xa9 2020 Mesto Russia"})})};var k=function(e){var t=e.card,n=e.onClose,a="popup popup_type_image ".concat(t?"popup_opened":"");return Object(m.jsx)("div",{className:a,children:Object(m.jsxs)("div",{className:"popup__container popup__container_image",children:[Object(m.jsx)("button",{type:"button","aria-label":"\u0417\u0430\u043a\u0440\u044b\u0442\u044c",className:"popup__close btn btn_type_close",onClick:n}),Object(m.jsx)("img",{src:t&&t.link,alt:t&&t.name,className:"popup__image"}),Object(m.jsx)("h2",{className:"popup__sign",children:t&&t.name})]})})};var N=function(e){var t=e.title,n=e.name,a=e.isOpen,c=e.onClose,i=e.onSubmit,s=e.children,r=e.submitting,o=e.disabled,l=e.buttonText,u=void 0===l?"\u0421\u043e\u0445\u0440\u0430\u043d\u0438\u0442\u044c":l,d="popup popup_type_".concat(n," ").concat(a&&"popup_opened"),b="form__save ".concat(o&&"form__save_disabled");return Object(m.jsx)("div",{className:d,children:Object(m.jsxs)("div",{className:"popup__container",children:[Object(m.jsx)("button",{type:"button","aria-label":"\u0417\u0430\u043a\u0440\u044b\u0442\u044c",className:"popup__close btn btn_type_close",onClick:c}),Object(m.jsx)("h2",{className:"popup__title",children:t}),Object(m.jsxs)("form",{name:"form-".concat(n),className:"form form_type_".concat(n),noValidate:!0,onSubmit:i,children:[s,Object(m.jsx)("button",{type:"submit",name:"save",className:b,disabled:o,children:r?Object(m.jsx)(C,{size:30,count:15,speed:700}):u})]})]})})},S=n(6);var L=function(e){var t=e.onChange,n=Object(a.useRef)();return Object(m.jsxs)("label",{className:"form__field",children:[Object(m.jsx)("input",Object(S.a)(Object(S.a)({},e),{},{onChange:function(e){var a=e.target,c=a.value,i=a.validity,s=a.validationMessage;i.valid?n.current.textContent="":n.current.textContent=s,t(c,i.valid)}})),Object(m.jsx)("span",{ref:n,className:"form__input-error name-input-error"})]})};var E=function(e){var t=e.onClose,n=e.onUpdateUser,c=e.open,i=e.submitting,s=Object(a.useContext)(u),r=Object(a.useState)(s.name),l=Object(o.a)(r,2),d=l[0],b=l[1],j=Object(a.useState)(s.about),p=Object(o.a)(j,2),f=p[0],_=p[1],O=Object(a.useState)(!0),h=Object(o.a)(O,2),v=h[0],x=h[1],C=Object(a.useState)(!0),g=Object(o.a)(C,2),y=g[0],k=g[1],S=Object(a.useState)(!0),E=Object(o.a)(S,2),P=E[0],D=E[1];return Object(a.useEffect)((function(){D(!(!v||!y))}),[v,y]),Object(a.useEffect)((function(){b(s.name),_(s.about)}),[s]),Object(m.jsxs)(N,{title:"\u0420\u0435\u0434\u0430\u043a\u0442\u0438\u0440\u043e\u0432\u0430\u0442\u044c \u043f\u0440\u043e\u0444\u0438\u043b\u044c",name:"edit-profile",isOpen:c,disabled:!P,onClose:t,onSubmit:function(e){e.preventDefault(),n({name:d,about:f})},submitting:i,children:[Object(m.jsx)(L,{type:"text",name:"name",id:"name-input",className:"form__input form__input_type_name",required:!0,minLength:"2",maxLength:"40",value:d,onChange:function(e,t){x(t),b(e)}}),Object(m.jsx)(L,{type:"text",name:"about",id:"about-input",className:"form__input form__input_type_about",required:!0,minLength:"2",maxLength:"200",value:f,onChange:function(e,t){k(t),_(e)}})]})};var P=function(e){var t=e.open,n=e.onClose,a=e.onUpdateAvatar,i=e.submitting,s=c.a.useRef();return Object(m.jsx)(N,{title:"\u041e\u0431\u043d\u043e\u0432\u0438\u0442\u044c \u0430\u0432\u0430\u0442\u0430\u0440",name:"update-profile",isOpen:t,onClose:n,onSubmit:function(e){e.preventDefault(),a({avatar:s.current.value})},submitting:i,children:Object(m.jsxs)("label",{className:"form__field",children:[Object(m.jsx)("input",{ref:s,type:"url",name:"avatar",id:"avatar-input",className:"form__input form__input_type_link",required:!0}),Object(m.jsx)("span",{className:"form__input-error avatar-input-error"})]})})};var D=function(e){var t=e.open,n=e.onClose,c=e.onAddPlace,i=e.submitting,s=Object(a.useState)(""),r=Object(o.a)(s,2),l=r[0],u=r[1],d=Object(a.useState)(""),b=Object(o.a)(d,2),j=b[0],p=b[1],f=Object(a.useState)(!1),_=Object(o.a)(f,2),O=_[0],h=_[1],v=Object(a.useState)(!1),x=Object(o.a)(v,2),C=x[0],g=x[1],y=Object(a.useState)(!1),k=Object(o.a)(y,2),S=k[0],E=k[1];return Object(a.useEffect)((function(){E(!(!O||!C))}),[O,C]),Object(m.jsxs)(N,{title:"\u041d\u043e\u0432\u043e\u0435 \u043c\u0435\u0441\u0442\u043e",name:"add-card",isOpen:t,disabled:!S,onClose:function(){h(!1),g(!1),u(""),p(""),n()},onSubmit:function(e){e.preventDefault(),c({name:l,link:j})},submitting:i,children:[Object(m.jsx)(L,{value:l,onChange:function(e,t){h(t),u(e)},type:"text",name:"name",id:"place-input",placeholder:"\u041d\u0430\u0437\u0432\u0430\u043d\u0438\u0435",className:"form__input form__input_type_card-name",required:!0,minLength:"2",maxLength:"30"}),Object(m.jsx)(L,{value:j,onChange:function(e,t){g(t),p(e)},type:"url",name:"link",id:"link-input",placeholder:"\u0421\u0441\u044b\u043b\u043a\u0430 \u043d\u0430 \u043a\u0430\u0440\u0442\u0438\u043d\u043a\u0443",className:"form__input form__input_type_link",required:!0})]})};var A=function(e){var t=e.cardId,n=e.onClose,a=e.onDeleteCard,c=e.submitting;return Object(m.jsx)(N,{title:"\u0412\u044b \u0443\u0432\u0435\u0440\u0435\u043d\u044b?",buttonText:"\u0414\u0430",name:"delete",isOpen:!!t,onClose:n,onSubmit:function(e){e.preventDefault(),a(t)},submitting:c,children:Object(m.jsx)("input",{type:"hidden",className:"form__input form__input_type_id",name:"id"})})};var U=function(){var e=Object(a.useState)(!0),t=Object(o.a)(e,2),n=t[0],c=t[1],i=Object(a.useState)(!1),s=Object(o.a)(i,2),l=s[0],d=s[1],b=Object(a.useState)(!1),f=Object(o.a)(b,2),O=f[0],h=f[1],v=Object(a.useState)(!1),x=Object(o.a)(v,2),C=x[0],N=x[1],S=Object(a.useState)(!1),L=Object(o.a)(S,2),U=L[0],T=L[1],w=Object(a.useState)([]),M=Object(o.a)(w,2),q=M[0],z=M[1],I=Object(a.useState)(null),R=Object(o.a)(I,2),J=R[0],H=R[1],B=Object(a.useState)(null),G=Object(o.a)(B,2),V=G[0],Y=G[1],F=Object(a.useState)(Object(a.useContext)(u)),K=Object(o.a)(F,2),Q=K[0],W=K[1],X=function(){h(!1),N(!1),T(!1),Y(null),H(null)};return Object(a.useEffect)((function(){c(!0),Promise.all([j.getUserInfo(),j.getCardList()]).then((function(e){var t=Object(o.a)(e,2),n=t[0],a=t[1];W(n),z(a)})).catch(p).finally((function(){c(!1)}))}),[]),Object(m.jsx)(u.Provider,{value:Q,children:Object(m.jsxs)("div",{className:"page",children:[Object(m.jsx)(_,{}),Object(m.jsx)(g,{cards:q,onCardLike:function(e){var t=e.likes.some((function(e){return e._id===Q._id}));j.like(e._id,!t).then((function(t){z((function(n){return n.map((function(n){return n._id===e._id?t:n}))}))}))},onCardDelete:function(e){Y(e)},onEditProfile:function(){N(!0)},onAddPlace:function(){T(!0)},onEditAvatar:function(){h(!0)},onCardClick:function(e){H(e)},loading:n}),Object(m.jsx)(y,{}),Object(m.jsx)(k,{card:J,onClose:X}),Object(m.jsx)(E,{open:C,onClose:X,onUpdateUser:function(e){d(!0),j.updateProfile(e).then((function(e){W(e),N(!1)})).catch(p).finally((function(){return d(!1)}))},submitting:l}),Object(m.jsx)(D,{open:U,onClose:X,onAddPlace:function(e){d(!0),j.postCard(e).then((function(e){z([e].concat(Object(r.a)(q))),T(!1)})).catch(p).finally((function(){return d(!1)}))},submitting:l}),Object(m.jsx)(A,{cardId:V,onClose:X,onDeleteCard:function(e){d(!0),j.delete(e).then((function(){z((function(t){return t.filter((function(t){return t._id!==e}))})),Y(null)})).catch(p).finally((function(){return d(!1)}))},submitting:l}),Object(m.jsx)(P,{open:O,onClose:X,onUpdateAvatar:function(e){d(!0),j.updateAvatar(e).then((function(e){W(e),h(!1)})).catch(p).finally((function(){return d(!1)}))},submitting:l})]})})};s.a.render(Object(m.jsx)(c.a.StrictMode,{children:Object(m.jsx)(U,{})}),document.getElementById("root"))}},[[17,1,2]]]);
//# sourceMappingURL=main.aa60c204.chunk.js.map